<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>React正篇 | 高级前端进阶</title><meta name="keywords" content="高级前端开发,JavaScript,面试,js,React,React.js,React面试题"><meta name="author" content="souldjl"><meta name="copyright" content="souldjl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="高级前端开发,JavaScript,面试,js,React,React.js,React面试题"><meta property="og:type" content="article"><meta property="og:title" content="React正篇"><meta property="og:url" content="https://www.daijl.cn/60006/index.html"><meta property="og:site_name" content="高级前端进阶"><meta property="og:description" content="高级前端开发,JavaScript,面试,js,React,React.js,React面试题"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.daijl.cn/img/cover/cover_9.jpg"><meta property="article:published_time" content="2022-02-08T06:21:30.000Z"><meta property="article:modified_time" content="2022-02-08T06:21:30.000Z"><meta property="article:author" content="souldjl"><meta property="article:tag" content="React"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.daijl.cn/img/cover/cover_9.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.daijl.cn/60006/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="T8zNWQNhDDztzYe6Y7pYKuJIY8LO45bxxN1iGheQnI"><meta name="baidu_site_verification" content="code-UTlFxDZspp"><meta name="sogou_site_verification" content="pSw0CiDaj7"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f30a76e6d5701be25349f80c829c0a52";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: souldjl",link:"链接: ",source:"来源: 高级前端进阶",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"null",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"React正篇",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-02-08 14:21:30"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0!==o){const a=new Date;o=864e5*o,o={value:t,expiry:a.getTime()+o};localStorage.setItem(e,JSON.stringify(o))}},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);const o=new Date;if(!(o.getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=a=>new Promise((t,e)=>{const o=document.createElement("script");o.src=a,o.async=!0,o.onerror=e,o.onload=o.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(o.onload=o.onreadystatechange=null,t())},document.head.appendChild(o)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme");"dark"===e?activateDarkMode():"light"===e&&activateLightMode();e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/Swiper/7.4.1/swiper-bundle.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">52</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/recommend-books/"><i class="fa-fw fas fa-link"></i><span> 书籍推荐</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tools"></i><span> 实用工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://nav.daijl.cn/"><span>编程导航</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">高级前端进阶</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/recommend-books/"><i class="fa-fw fas fa-link"></i><span> 书籍推荐</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tools"></i><span> 实用工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://nav.daijl.cn/"><span>编程导航</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">React正篇</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-08T06:21:30.000Z" title="发表于 2022-02-08 14:21:30">2022-02-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-02-08T06:21:30.000Z" title="更新于 2022-02-08 14:21:30">2022-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%A1%86%E6%9E%B6/React/">React</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="React正篇"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/60006/#post-comment"><span class="gitalk-comment-count"></span></a></span></div></div></div><article class="post-content" id="article-container"><h2 id="3-1-事件处理"><a href="#3-1-事件处理" class="headerlink" title="3.1 事件处理"></a>3.1 事件处理</h2><h3 id="3-1-1-react事件和DOM事件"><a href="#3-1-1-react事件和DOM事件" class="headerlink" title="3.1.1 react事件和DOM事件"></a>3.1.1 react事件和DOM事件</h3><table><thead><tr><th align="center">react事件</th><th align="center">原生事件</th></tr></thead><tbody><tr><td align="center">onClick</td><td align="center">onclick</td></tr><tr><td align="center">onClick={eventListener}</td><td align="center">onclick=”eventListener()”</td></tr><tr><td align="center">e.preventDefalut</td><td align="center">onclick=”javascript”</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class ListItem extends Component &#123;</span><br><span class="line">     constructor(props)&#123;</span><br><span class="line">     super(props) //子类中调用父类构造函数</span><br><span class="line">   &#125;</span><br><span class="line">   doSomethind()&#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">    handleClick(e)&#123;</span><br><span class="line">        console.log(e)</span><br><span class="line">        this.doSomethind() //报错，会说找不到这个方法</span><br><span class="line">    &#125;</span><br><span class="line">   render()&#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">        &lt;span onclick=&#123;this.handleClick&#125;&gt;header&lt;span&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">    )</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>在面向对象的编程中，this的使用方法会随着引用对象的差别而不同，当被对象引用时指向的是对象，单独函数引用指向的是window，严格模式是<code>undefined</code>，那我们在react中怎么解决这个问题呢？</p><h3 id="3-1-2-this关键词的处理"><a href="#3-1-2-this关键词的处理" class="headerlink" title="3.1.2 this关键词的处理"></a>3.1.2 this关键词的处理</h3><ul><li>在jsx中使用bind方法</li><li>在构造函数中使用bind方法</li><li>使用箭头函数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class ListItem extends Component &#123;</span><br><span class="line">     constructor(props)&#123;</span><br><span class="line">     super(props) //子类中调用父类构造函数</span><br><span class="line">     // 方法2</span><br><span class="line">     this.handleClick=this.handleClick.bind(this)</span><br><span class="line">   &#125;</span><br><span class="line">   doSomethind()&#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">    // 方法3，推荐使用，箭头函数的this总是指向定义时的对象，而不是运行时</span><br><span class="line">    handleClick=(e)=&gt;&#123;</span><br><span class="line">        console.log(e)</span><br><span class="line">        this.doSomethind() //报错，会说找不到这个方法</span><br><span class="line">    &#125;</span><br><span class="line">   render()&#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">        &#123;/*方法1*/&#125;</span><br><span class="line">        &lt;span onclick=&#123;this.handleClick.bind(this)&#125;&gt;header&lt;span&gt;   </span><br><span class="line">      &lt;div&gt;</span><br><span class="line">    )</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-3-向事件处理程序传递参数"><a href="#3-1-3-向事件处理程序传递参数" class="headerlink" title="3.1.3 向事件处理程序传递参数"></a>3.1.3 向事件处理程序传递参数</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class ListItem extends Component &#123;</span><br><span class="line">     constructor(props)&#123;</span><br><span class="line">     super(props) //子类中调用父类构造函数)</span><br><span class="line">     this.state=&#123;</span><br><span class="line">         conunt:1</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">    handleClick(id)&#123;</span><br><span class="line">        console.log(id)</span><br><span class="line">    &#125;</span><br><span class="line">   render()&#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">       &#123;/* 方法1*/&#125;</span><br><span class="line">        &lt;span onclick=&#123;this.handleClick.bind(this,1)&#125;&gt;header&lt;span&gt; </span><br><span class="line">         &#123;/* 方法2*/&#125;</span><br><span class="line">        &lt;span onclick=&#123;()=&gt;this.handleClick(1)&#125;&gt;header&lt;span&gt;  </span><br><span class="line">          &#123;/* 传递事件对象event*/&#125;</span><br><span class="line">        &lt;span onclick=&#123;(e)=&gt;this.handleClick(1,e)&#125;&gt;header&lt;span&gt;  </span><br><span class="line">      &lt;div&gt;</span><br><span class="line">    )</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-4-向父组件传递参数"><a href="#3-1-4-向父组件传递参数" class="headerlink" title="3.1.4 向父组件传递参数"></a>3.1.4 向父组件传递参数</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 父组件</span><br><span class="line">class App extends Component &#123;</span><br><span class="line">    handDelete(id)&#123;</span><br><span class="line">        console.log(id)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        &lt;ListItem onDelete=&#123;this.handDelete&#125;/&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 子组件</span><br><span class="line">class ListItem extends Component &#123;</span><br><span class="line">     constructor(props)&#123;</span><br><span class="line">     super(props)</span><br><span class="line">     this.state=&#123;</span><br><span class="line">         conunt:1</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   render()&#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">        &lt;span onclick=&#123;()=&gt;this.props.onDelete(this.state.conunt)&#125;&gt;header&lt;span&gt;  </span><br><span class="line">      &lt;div&gt;</span><br><span class="line">    )</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-5-React事件机制"><a href="#3-1-5-React事件机制" class="headerlink" title="3.1.5 React事件机制"></a>3.1.5 React事件机制</h3><h4 id="DOM事件"><a href="#DOM事件" class="headerlink" title="DOM事件"></a>DOM事件</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/domhandle.png"></p><p>在js的事件触发经过3个阶段，事件的捕获-&gt;目标对象事件的处理-&gt;事件冒泡，假设在<code>text</code>中触发了事件，会经过一个捕获的阶段，父级元素将事件一直传递到本身发生的元素上，在经过本身的事件处理之后，会经历冒泡饿阶段，事件从子元素向父元素冒泡；就因为这样，事件委托成为了可能，就是将子元素的事件处理委托给父元素。</p><h4 id="react事件"><a href="#react事件" class="headerlink" title="react事件"></a>react事件</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/reacthandle.png"></p><p>react会将所有的事件都绑定到document上，而不是某个元素上面，统一的使用事件监听，并在冒泡阶段处理事件，当挂载和卸载组件的时候<br>只需在统一的事件监听位置，增加或删除对象，因此极大的提高效率；当事件触发的时候，我们的组件会生成一个合成事件，然后传递到<code>documennt</code>中，doucument会通过<code>DispatchEvent</code>回调函数依次执行<code>DispatchEvent</code>中同类型的事件监听函数，事件注册是在组件生成的时候，我们将vDom中所有的事件的原生事件<code>documennt</code>中的一个监听器当中，也就是所有的事件处理函数都存在<code>ListenerBank</code>中<br>并以<code>key</code>作为索引，这样的好处是将可能要触发的事件分门别类。</p><p>react事件要素</p><ul><li>react事件是合成事件，不是DOM原生事件</li><li>在document监听所有支持的事件</li><li>使用统一的分发函数dispatchEvent</li></ul><h3 id="3-1-6-扩展学习"><a href="#3-1-6-扩展学习" class="headerlink" title="3.1.6 扩展学习"></a>3.1.6 扩展学习</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/25883536">源码分析事件</a></p><p><a target="_blank" rel="noopener" href="http://react.html.cn/docs/events.html">合成事件</a></p><h2 id="3-2-认识State"><a href="#3-2-认识State" class="headerlink" title="3.2 认识State"></a>3.2 认识State</h2><p>安装<code>react-devtools</code>调试工具</p><p>方法1:有条件的可以在谷歌商店安装</p><p>方法2:没有条件的看地址安装<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-devtools">点击我</a></p><h3 id="3-2-1-如何定义State"><a href="#3-2-1-如何定义State" class="headerlink" title="3.2.1 如何定义State"></a>3.2.1 如何定义State</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">super</span>(props)</span><br><span class="line">   <span class="built_in">this</span>.state=&#123; <span class="comment">//定义一个state</span></span><br><span class="line">       <span class="attr">conunt</span>:<span class="number">1</span> </span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">      &lt;span&gt;&#123;this.state.count&#125;&lt;span&gt;  </span><br><span class="line">    &lt;div&gt;</span><br><span class="line">  )</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="3-2-2-修改State"><a href="#3-2-2-修改State" class="headerlink" title="3.2.2 修改State"></a>3.2.2 修改State</h3><ul><li>使用setState</li><li>setState是异步的</li><li>State的更新是一个浅合并（shalllow merge）的过程</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">super</span>(props)</span><br><span class="line">   <span class="built_in">this</span>.state=&#123;</span><br><span class="line">       <span class="attr">conunt</span>:<span class="number">1</span> </span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">addCunt</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">&#x27;step1&#x27;</span>,<span class="built_in">this</span>.state.count)</span><br><span class="line">     <span class="built_in">this</span>.setState(&#123; <span class="comment">//修改一个state</span></span><br><span class="line">         <span class="attr">count</span>:<span class="built_in">this</span>.state.count+<span class="number">1</span></span><br><span class="line">     &#125;)</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">&#x27;step2&#x27;</span>,<span class="built_in">this</span>.state.count)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">      &lt;span onclick=&#123;()=&gt;this.addCount()&#125;&gt;&#123;this.state.count&#125;&lt;span&gt;  </span><br><span class="line">    &lt;div&gt;</span><br><span class="line">  )</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>addCount函数中打印的2次<code>conut</code>的值是一样的，说明setState的处理过程是异步的而不是同步的,react在执行setState时候，优化执行的时机，多个setState合并在一起去执行，如果非要在state变化话后做一些操作的话，其实setState会接收第二个参数。</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">super</span>(props)</span><br><span class="line">   <span class="built_in">this</span>.state=&#123;</span><br><span class="line">       <span class="attr">conunt</span>:<span class="number">1</span> </span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">addCunt</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">this</span>.setState(&#123; <span class="comment">//修改一个state</span></span><br><span class="line">         <span class="attr">count</span>:<span class="built_in">this</span>.state.count+<span class="number">1</span></span><br><span class="line">     &#125;,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">&#x27;step3&#x27;</span>,<span class="built_in">this</span>.state.count) <span class="comment">// 可以拿到修改后的值</span></span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#x27;listItem&#x27;&gt;</span><br><span class="line">      &lt;span onclick=&#123;()=&gt;this.addCount()&#125;&gt;&#123;this.state.count&#125;&lt;span&gt;  </span><br><span class="line">    &lt;div&gt;</span><br><span class="line">  )</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="3-2-3-创建新的状态"><a href="#3-2-3-创建新的状态" class="headerlink" title="3.2.3 创建新的状态"></a>3.2.3 创建新的状态</h3><p>修改state我们都要遵循状态都应该是不可变数据</p><h4 id="什么是不可变数据"><a href="#什么是不可变数据" class="headerlink" title="什么是不可变数据"></a>什么是不可变数据</h4><p>不可变数据是函数式编程的重要概念，就是我们对已经初始化的数据不进行更改，每次更改都是创建新的对象来承载新的数据状态</p><p>状态类型</p><ul><li>值类型：string、number、boolean、null、undefined</li><li>数组类型</li><li>对象</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.状态的类型是值类型</span></span><br><span class="line"><span class="built_in">this</span>.setState(&#123;</span><br><span class="line">    <span class="attr">count</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">    <span class="attr">show</span>:<span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2.状态的类型是数组</span></span><br><span class="line"><span class="keyword">const</span> _books=<span class="built_in">this</span>.state.books.concat(<span class="string">&#x27;new book&#x27;</span>)</span><br><span class="line">   <span class="comment">// 或</span></span><br><span class="line"><span class="keyword">const</span> _books=[...this.state.books,<span class="string">&#x27;new book&#x27;</span>)]</span><br><span class="line"><span class="built_in">this</span>.setState(&#123;</span><br><span class="line">    <span class="attr">books</span>:_books</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2.状态的类型是对象</span></span><br><span class="line"><span class="keyword">const</span> _item=<span class="built_in">Object</span>.assign(&#123;&#125;,<span class="built_in">this</span>.state.item,&#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">ame</span>:<span class="string">&#x27;zs&#x27;</span>&#125;)</span><br><span class="line">    <span class="comment">// 或</span></span><br><span class="line"><span class="keyword">const</span> _item=&#123;...this.state.item,<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">ame</span>:<span class="string">&#x27;zs&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">this</span>.setState(&#123;</span><br><span class="line">    <span class="attr">item</span>:_item</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>上面创建新的对象都是浅拷贝，如果要深拷贝可以用immutable.js类库 来处理不可变数据。</p><h3 id="3-2-4-扩展资料"><a href="#3-2-4-扩展资料" class="headerlink" title="3.2.4 扩展资料"></a>3.2.4 扩展资料</h3><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-devtools">React Dev Tools</a></p><p><a target="_blank" rel="noopener" href="https://juejin.im/entry/59a980306fb9a02485103d0b">状态组件和无状态组件</a></p><p><a target="_blank" rel="noopener" href="https://juejin.im/post/5bf1444cf265da614a3a1660">setState异步的理解</a></p><h2 id="3-3-State进阶"><a href="#3-3-State进阶" class="headerlink" title="3.3 State进阶"></a>3.3 State进阶</h2><h3 id="3-3-1-通过条件判断优化渲染"><a href="#3-3-1-通过条件判断优化渲染" class="headerlink" title="3.3.1 通过条件判断优化渲染"></a>3.3.1 通过条件判断优化渲染</h3><p>下面代码是我们渲染一个列表，当我们删除第一行列表的时候，其它2个列表其实没有任何变化，但是它们的render方法还是执行了，执行了render方法其实也要diff对比，当一个大型的项目，这显然也是很耗时的，所以我们要优化它，优化有2种方法：</p><ol><li><p>sholudComponentUpdate(利用这个钩子阻止，如果子组件没有变化就不进行渲染)</p></li><li><p>PureComponent（利用react提供的组件）</p></li></ol><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/shouldUpdate.png"></p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ListItem <span class="keyword">from</span> <span class="string">&#x27;./listItem&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stated</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123; </span><br><span class="line">        <span class="attr">listData</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;Sony 65寸高清液晶电视&quot;</span>,</span><br><span class="line">              <span class="attr">price</span>: <span class="number">7000</span>,</span><br><span class="line">              <span class="attr">stock</span>: <span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;华为 Meta30&quot;</span>,</span><br><span class="line">              <span class="attr">price</span>: <span class="number">6000</span>,</span><br><span class="line">              <span class="attr">stock</span>: <span class="number">2</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">id</span>: <span class="number">3</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;华硕画家国度笔记本电脑&quot;</span>,</span><br><span class="line">              <span class="attr">price</span>: <span class="number">10000</span>,</span><br><span class="line">              <span class="attr">stock</span>: <span class="number">3</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="title">renderList</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span>  <span class="built_in">this</span>.state.listData.map(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ListItem</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span> <span class="attr">data</span>=<span class="string">&#123;item&#125;</span> <span class="attr">onDelete</span>=<span class="string">&#123;this.handDelete&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">ListItem</span>&gt;</span></span></span><br><span class="line">        &#125;)</span><br><span class="line">     &#125;</span><br><span class="line">     handDelete=<span class="function">(<span class="params">id</span>)=&gt;</span>&#123;</span><br><span class="line">         <span class="keyword">const</span> listData=<span class="built_in">this</span>.state.listData.filter(<span class="function"><span class="params">item</span>=&gt;</span>item.id!==id)</span><br><span class="line">         <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">            listData</span><br><span class="line">         &#125;)       </span><br><span class="line">     &#125;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> (  </span><br><span class="line">            <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                &#123;this.state.listData.length&lt;=0 &amp;&amp; <span class="tag">&lt;<span class="name">div</span>&gt;</span>购物车为空<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="xml">                &#123;this.renderList()&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Stated;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;  &#125;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123; </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;item render--虚拟dom&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> (  </span><br><span class="line">            <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;this.props.data.name&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="xml">                    this.props.onDelete(this.props.data.id)</span></span><br><span class="line"><span class="xml">                &#125;&#125;&gt;删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ListItem;</span><br></pre></td></tr></table></figure><h4 id="sholudComponentUpdate"><a href="#sholudComponentUpdate" class="headerlink" title="sholudComponentUpdate"></a>sholudComponentUpdate</h4><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;  &#125;</span><br><span class="line">    <span class="function"><span class="title">shouldComponentUpdate</span>(<span class="params">nextProps,nextState</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nextProps.data.id===<span class="built_in">this</span>.props.data.id) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ListItem;</span><br></pre></td></tr></table></figure><h4 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h4><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">import</span> React,&#123;PrueComponent&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> ListItem <span class="keyword">from</span> <span class="string">&#x27;./listItem&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stated</span> <span class="keyword">extends</span> <span class="title">PrueComponent</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-2-单一数据源"><a href="#3-3-2-单一数据源" class="headerlink" title="3.3.2 单一数据源"></a>3.3.2 单一数据源</h3><p>尊崇单一数据源，相同的子组件的数据应该由父组件通过<code>props</code>传递子组件，由父组件统一管理，避免造成数据的混乱，使用这个原则的时候，当父组件任何一个<br>状态的改变，会自动更新子组件这一部分，从上而下传达到子组件的，是同步的方法，子组件想操作数据，由父组件提供更新函数。</p><h3 id="3-3-3-状态提升"><a href="#3-3-3-状态提升" class="headerlink" title="3.3.3 状态提升"></a>3.3.3 状态提升</h3><p>当我们的子组件都要控制同一个数据源的时候，我们需要将数据提升到它们共同的父组件当中，然后父组件通过props传递给子组件，并由父组件进行统一管理和存储。</p><h3 id="3-3-4-为什么使用不可变数据"><a href="#3-3-4-为什么使用不可变数据" class="headerlink" title="3.3.4 为什么使用不可变数据"></a>3.3.4 为什么使用不可变数据</h3><ol><li>可回溯</li></ol><p>不直接在数据上修改，方便我们追溯以前的历史记录。</p><ol start="2"><li>跟踪数据改变</li></ol><p>直接修改数据，跟踪数据的改变需要把当前数据和以前数据的版本进行对比，这样整个对象树都要遍历一次<br>如果使用不可变数据，创建新的对象，这样我们发现是一个新的对象，那我们不需要对象树对比就知道数据发生了变化，因为对象不是同一个引用了</p><ol start="3"><li>确定在react中何时重新渲染</li></ol><p>不可变性最主要优势在于它可以帮助我们在react中创建Pure components，我们可以轻松确定不可变数据是否发生了改变，从而确实何时对组件进行重新渲染</p><h3 id="3-3-5-有状态组件和无状态组件"><a href="#3-3-5-有状态组件和无状态组件" class="headerlink" title="3.3.5 有状态组件和无状态组件"></a>3.3.5 有状态组件和无状态组件</h3><h4 id="Stateful"><a href="#Stateful" class="headerlink" title="Stateful"></a>Stateful</h4><ul><li>类组件</li><li>有状态组件</li><li>容器组件</li></ul><h4 id="Stateless"><a href="#Stateless" class="headerlink" title="Stateless"></a>Stateless</h4><ul><li>函数组件</li><li>无状态组件</li><li>展示组件</li></ul><p>无状态组件，所有数据源都来自于父组件，它只做展示的作用</p><p>尽可能通过状态提升原则，将需要的状态提取到父组件中，而其他的组件使用无状态组件编写</p><h3 id="3-3-6-扩展资料"><a href="#3-3-6-扩展资料" class="headerlink" title="3.3.6 扩展资料"></a>3.3.6 扩展资料</h3><p><a target="_blank" rel="noopener" href="https://github.com/immutable-js/immutable-js">不可变数据</a></p><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Memory_Management">JS内存管理</a></p><p><a target="_blank" rel="noopener" href="http://huziketang.mangojuice.top/books/react/lesson17">状态提升</a></p><p><a target="_blank" rel="noopener" href="http://react.html.cn/docs/context.html">context管理状态</a></p><p><a target="_blank" rel="noopener" href="https://juejin.im/post/5a90e0545188257a63112977">context管理状态</a></p><h2 id="3-4-生命周期"><a href="#3-4-生命周期" class="headerlink" title="3.4 生命周期"></a>3.4 生命周期</h2><h3 id="3-4-1-三个阶段的生命周期函数"><a href="#3-4-1-三个阶段的生命周期函数" class="headerlink" title="3.4.1 三个阶段的生命周期函数"></a>3.4.1 三个阶段的生命周期函数</h3><h4 id="三个阶段生命周期"><a href="#三个阶段生命周期" class="headerlink" title="三个阶段生命周期"></a>三个阶段生命周期</h4><p>创建阶段-&gt;更新阶段-&gt;卸载阶段</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/lifeCycle.png"></p><h3 id="3-4-2-创建阶段"><a href="#3-4-2-创建阶段" class="headerlink" title="3.4.2 创建阶段"></a>3.4.2 创建阶段</h3><h4 id="1-创建阶段constructor"><a href="#1-创建阶段constructor" class="headerlink" title="1. 创建阶段constructor"></a>1. 创建阶段constructor</h4><ul><li><p>初始化内部状态，显性设置和隐性设置</p><p>一个类必须有<code>constructor</code>方法，如果这个方法没有显示定义，一个默认的<code>constructor</code>方法会被添加</p></li><li><p>需要使用super()调用基类的构造函数</p><p>将父类的props注入给子组件</p></li><li><p>可以直接修改state</p><h4 id="2-创建阶段componentWillMount-16-3移除"><a href="#2-创建阶段componentWillMount-16-3移除" class="headerlink" title="2. 创建阶段componentWillMount(16.3移除)"></a>2. 创建阶段componentWillMount(16.3移除)</h4></li><li><p>UI渲染完成前调用</p></li><li><p>只执行一次</p></li><li><p>这里调用setState不会触发render</p></li></ul><p>更多的时候我们把组件里面的内容，会提前到<code>constructor</code>中，所以这个生命周期函数在项目中我们很少使用</p><h4 id="3-创建阶段render"><a href="#3-创建阶段render" class="headerlink" title="3. 创建阶段render"></a>3. 创建阶段render</h4><ul><li>一个组件必须有的方法（我们的类组件）</li><li>返回一个顶级的react元素<br>只能有一个根元素，不能返回并列元素</li><li>渲染的是Dom Tree的一个React对象</li></ul><h4 id="4-创建阶段componentDidMount"><a href="#4-创建阶段componentDidMount" class="headerlink" title="4. 创建阶段componentDidMount"></a>4. 创建阶段componentDidMount</h4><ul><li>UI渲染完成后调用</li><li>只执行一次</li><li>获取一些外部数据资源</li></ul><p>需要注意的是当父组件执行render的时候，当所有子组件都完成了创建，那么父组件才能最终的完成渲染，然后父组件执行componentDidMount</p><h3 id="3-4-3-更新阶段"><a href="#3-4-3-更新阶段" class="headerlink" title="3.4.3 更新阶段"></a>3.4.3 更新阶段</h3><p>当state和props发生变化时，进入更新阶段</p><h4 id="1-更新阶段componentWillReceiveProps-16-3移除"><a href="#1-更新阶段componentWillReceiveProps-16-3移除" class="headerlink" title="1.更新阶段componentWillReceiveProps(16.3移除)"></a>1.更新阶段componentWillReceiveProps(16.3移除)</h4><p>只接收props</p><ul><li>组件接收到新props的时候触发</li><li>在此对比新props和原来的props</li><li>不推荐使用</li></ul><h4 id="2-更新阶段shouldComponentUpdate"><a href="#2-更新阶段shouldComponentUpdate" class="headerlink" title="2.更新阶段shouldComponentUpdate"></a>2.更新阶段shouldComponentUpdate</h4><p>接收state和props</p><ul><li>是否要继续执行render方法</li><li>可以由PureComponent自动实现</li></ul><h4 id="3-更新阶段componentDidUpdate"><a href="#3-更新阶段componentDidUpdate" class="headerlink" title="3.更新阶段componentDidUpdate"></a>3.更新阶段componentDidUpdate</h4><ul><li>每次UI更新时调用</li><li>更新一些外部数据资源</li></ul><h3 id="3-4-4-卸载阶段-componentWillUnmount"><a href="#3-4-4-卸载阶段-componentWillUnmount" class="headerlink" title="3.4.4 卸载阶段 componentWillUnmount"></a>3.4.4 卸载阶段 componentWillUnmount</h3><ul><li>组件移除时调用</li><li>可以用来做资源的释放</li></ul><h3 id="3-4-5-图解生命周期"><a href="#3-4-5-图解生命周期" class="headerlink" title="3.4.5 图解生命周期"></a>3.4.5 图解生命周期</h3><h4 id="旧的生命周期"><a href="#旧的生命周期" class="headerlink" title="旧的生命周期"></a>旧的生命周期</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/usedLifecycle.png"></p><h4 id="新的生命周期"><a href="#新的生命周期" class="headerlink" title="新的生命周期"></a>新的生命周期</h4><p>16.3以后移除了 componentWillmount、componentWillReceiveProps、componentWillUpdate</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/newLifecycle.png"></p><h3 id="3-4-6-扩展资料"><a href="#3-4-6-扩展资料" class="headerlink" title="3.4.6 扩展资料"></a>3.4.6 扩展资料</h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/514fe21b9914">React新生命周期1</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/38030418">React新生命周期2</a></p><h2 id="3-5-React组件设计模式"><a href="#3-5-React组件设计模式" class="headerlink" title="3.5 React组件设计模式"></a>3.5 React组件设计模式</h2><h3 id="3-5-1-高阶组件"><a href="#3-5-1-高阶组件" class="headerlink" title="3.5.1 高阶组件"></a>3.5.1 高阶组件</h3><p>在业务中可能碰到许多要复用业务逻辑的情况，我们为了避免每个组件都写一段相同逻辑的代码，我们就用高阶组件。</p><p>高阶组件是对已有组件的封装，形成新的组件后，有自己的状态和逻辑；并可以传递已有的组件</p><p>高阶组件就是接收组件作为参数，并返回新的组件</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> NewComponent=higherOrderComponent(OldComponent)</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/higherOrder.png"></p><h4 id="案例：假如多个组件需要鼠标滑入时给个提示，滑出时清空提示，那么可以把这个公共提示抽离出来复用"><a href="#案例：假如多个组件需要鼠标滑入时给个提示，滑出时清空提示，那么可以把这个公共提示抽离出来复用" class="headerlink" title="案例：假如多个组件需要鼠标滑入时给个提示，滑出时清空提示，那么可以把这个公共提示抽离出来复用"></a>案例：假如多个组件需要鼠标滑入时给个提示，滑出时清空提示，那么可以把这个公共提示抽离出来复用</h4><p>目录</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">src/  </span><br><span class="line">    components/</span><br><span class="line">       Item/</span><br><span class="line">         index.jsx</span><br><span class="line">         withTooltip.js</span><br></pre></td></tr></table></figure><p>封装Hoc组件（withTooltip.js）</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> withTooltip=<span class="function">(<span class="params">Component</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Hoc</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        state=&#123;</span><br><span class="line">            <span class="attr">showToolTip</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">content</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        handleOver=<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;<span class="attr">showToolTip</span>:<span class="literal">true</span>,<span class="attr">content</span>:e.target.innerText&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        handleOut=<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;<span class="attr">showToolTip</span>:<span class="literal">true</span>,<span class="attr">content</span>:<span class="string">&#x27;&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span>(</span><br><span class="line">                <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onMouseOver</span>=<span class="string">&#123;this.handleOver&#125;</span> <span class="attr">onMouseOut</span>=<span class="string">&#123;this.handleOut&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">Component</span> <span class="attr">action</span>=<span class="string">&#123;this.state&#125;</span> &#123;<span class="attr">...props</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">Component</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Hoc</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withTooltip</span><br></pre></td></tr></table></figure><p>在需要的组件引入并调用（index.jsx）</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import withTooltip from &#x27;./withTooltip&#x27;</span><br><span class="line">const ItemA = (props) =&gt; &#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;div className=&quot;container&quot;&gt;</span><br><span class="line">            &lt;button&gt;Tooltip&lt;/button&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                props.action.showToolTip &amp;&amp; &lt;div&gt;&#123;props.action.content&#125;&lt;/div&gt;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line">export default withTooltip(ItemA)</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/higherOrder2.png"></p><h4 id="高阶组件特性"><a href="#高阶组件特性" class="headerlink" title="高阶组件特性"></a>高阶组件特性</h4><ul><li>一个函数，传入一个组件，返回一个新组件</li><li>一般不会有ui展现</li><li>提供一些可复用的功能</li></ul><h3 id="3-5-2-函数作为子组件（renderProps）"><a href="#3-5-2-函数作为子组件（renderProps）" class="headerlink" title="3.5.2 函数作为子组件（renderProps）"></a>3.5.2 函数作为子组件（renderProps）</h3><p>解决复用业务逻辑的问题，是指一种在组件之间使用一个值为函数的props，来共享代码的的设计模式</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="~@/react/renderProps.png"></p><h4 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h4><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.定义子组件</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                &#123;this.props.render(this.state)&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 2.使用函数作为Props</span></span><br><span class="line">&lt;RenderPropComponent render=&#123;</span><br><span class="line">    <span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            content</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;/&gt;</span><br></pre></td></tr></table></figure><h4 id="改写上面的案例"><a href="#改写上面的案例" class="headerlink" title="改写上面的案例"></a>改写上面的案例</h4><p>目录</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">src/  </span><br><span class="line">    components/</span><br><span class="line">       Rp/</span><br><span class="line">         index.jsx</span><br><span class="line">         withTooltip.js</span><br></pre></td></tr></table></figure><p>定义子组件（withTooltip.js）</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">WithTooltip</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        state=&#123;</span><br><span class="line">            <span class="attr">showToolTip</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">content</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        handleOver=<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;<span class="attr">showToolTip</span>:<span class="literal">true</span>,<span class="attr">content</span>:e.target.innerText&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        handleOut=<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;<span class="attr">showToolTip</span>:<span class="literal">true</span>,<span class="attr">content</span>:<span class="string">&#x27;&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span>(</span><br><span class="line">                <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onMouseOver</span>=<span class="string">&#123;this.handleOver&#125;</span> <span class="attr">onMouseOut</span>=<span class="string">&#123;this.handleOut&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    &#123;this.props.render(this.state)&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> WithTooltip</span><br></pre></td></tr></table></figure><p>定义父组件（index.jsx)</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> WithTooltip <span class="keyword">from</span> <span class="string">&#x27;./withTooltip&#x27;</span></span><br><span class="line"><span class="keyword">const</span> ItemA = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;<span class="name">WithTooltip</span> </span></span></span><br><span class="line"><span class="tag"><span class="xml">                  <span class="attr">render</span>=<span class="string">&#123;(&#123;showToolTip,content&#125;)</span>=&gt;</span>(</span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                      <span class="tag">&lt;<span class="name">button</span>&gt;</span>Tooltip<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        &#123;</span></span><br><span class="line"><span class="xml">                        showToolTip &amp;&amp; <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;content&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                )&#125;&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">WithTooltip</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ItemA</span><br></pre></td></tr></table></figure><h3 id="3-5-3-函数作为子组件（Children）"><a href="#3-5-3-函数作为子组件（Children）" class="headerlink" title="3.5.3 函数作为子组件（Children）"></a>3.5.3 函数作为子组件（Children）</h3><p>改写成函数作为子组件（更加直观）推荐</p><p>定义子组件</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">    class WithTooltip extends React.Component &#123;</span><br><span class="line">        state=&#123;</span><br><span class="line">            showToolTip:false,</span><br><span class="line">            content:&#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        handleOver=(e)=&gt;&#123;</span><br><span class="line">            this.setState(&#123;showToolTip:true,content:e.target.innerText&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        handleOut=()=&gt;&#123;</span><br><span class="line">            this.setState(&#123;showToolTip:true,content:&#x27;&#x27;&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        render()&#123;</span><br><span class="line">            return(</span><br><span class="line">                &lt;div onMouseOver=&#123;this.handleOver&#125; onMouseOut=&#123;this.handleOut&#125;&gt;</span><br><span class="line">                    &#123;this.props.children(this.state)&#125;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">export default WithTooltip</span><br></pre></td></tr></table></figure><p>定义父组件</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import WithTooltip from &#x27;./withTooltip&#x27;</span><br><span class="line">const ItemB = (props) =&gt; &#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;div className=&quot;container&quot;&gt;</span><br><span class="line">              &lt;WithTooltip&gt;</span><br><span class="line">                &#123;(&#123;showToolTip,content&#125;)=&gt;(</span><br><span class="line">                    &lt;div&gt;</span><br><span class="line">                      &lt;button&gt;Tooltip&lt;/button&gt;</span><br><span class="line">                        &#123;</span><br><span class="line">                        showToolTip &amp;&amp; &lt;div&gt;&#123;content&#125;&lt;/div&gt;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                )&#125;</span><br><span class="line">            &lt;/WithTooltip&gt;</span><br><span class="line">    </span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line">export default ItemB</span><br></pre></td></tr></table></figure><h3 id="3-5-4-扩展阅读"><a href="#3-5-4-扩展阅读" class="headerlink" title="3.5.4 扩展阅读"></a>3.5.4 扩展阅读</h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ff6b3008820a">扩展阅读1</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/62791765">扩展阅读2</a></p></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/React/">React</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover_9.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/file/donate.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/file/donate.png" alt="wechat"></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/10279/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_7.jpg" onerror='onerror=null,src="/img/404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">React生态</div></div></a></div><div class="next-post pull-right"><a href="/10919/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_3.jpg" onerror='onerror=null,src="/img/404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">步入React</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/11239/" title="入门介绍"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">入门介绍</div></div></a></div><div><a href="/10919/" title="步入React"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">步入React</div></div></a></div><div><a href="/10279/" title="React生态"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">React生态</div></div></a></div><div><a href="/59622/" title="React原理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">React原理</div></div></a></div><div><a href="/59814/" title="React状态管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">React状态管理</div></div></a></div><div><a href="/59815/" title="React高级实战"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-08</div><div class="title">React高级实战</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">总结整理前端知识点 \(￣︶￣*\))<br>持续更新中...<br>ヾ(•ω•`)o</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">3.1 事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-react%E4%BA%8B%E4%BB%B6%E5%92%8CDOM%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">3.1.1 react事件和DOM事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-this%E5%85%B3%E9%94%AE%E8%AF%8D%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">3.1.2 this关键词的处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-%E5%90%91%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">3.1.3 向事件处理程序传递参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-4-%E5%90%91%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-number">1.4.</span> <span class="toc-text">3.1.4 向父组件传递参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-5-React%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6"><span class="toc-number">1.5.</span> <span class="toc-text">3.1.5 React事件机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DOM%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.5.1.</span> <span class="toc-text">DOM事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#react%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.5.2.</span> <span class="toc-text">react事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.6.</span> <span class="toc-text">3.1.6 扩展学习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E8%AE%A4%E8%AF%86State"><span class="toc-number">2.</span> <span class="toc-text">3.2 认识State</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89State"><span class="toc-number">2.1.</span> <span class="toc-text">3.2.1 如何定义State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E4%BF%AE%E6%94%B9State"><span class="toc-number">2.2.</span> <span class="toc-text">3.2.2 修改State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%8A%B6%E6%80%81"><span class="toc-number">2.3.</span> <span class="toc-text">3.2.3 创建新的状态</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.1.</span> <span class="toc-text">什么是不可变数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-%E6%89%A9%E5%B1%95%E8%B5%84%E6%96%99"><span class="toc-number">2.4.</span> <span class="toc-text">3.2.4 扩展资料</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-State%E8%BF%9B%E9%98%B6"><span class="toc-number">3.</span> <span class="toc-text">3.3 State进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-%E9%80%9A%E8%BF%87%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E4%BC%98%E5%8C%96%E6%B8%B2%E6%9F%93"><span class="toc-number">3.1.</span> <span class="toc-text">3.3.1 通过条件判断优化渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sholudComponentUpdate"><span class="toc-number">3.1.1.</span> <span class="toc-text">sholudComponentUpdate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PureComponent"><span class="toc-number">3.1.2.</span> <span class="toc-text">PureComponent</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-%E5%8D%95%E4%B8%80%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-number">3.2.</span> <span class="toc-text">3.3.2 单一数据源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-%E7%8A%B6%E6%80%81%E6%8F%90%E5%8D%87"><span class="toc-number">3.3.</span> <span class="toc-text">3.3.3 状态提升</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-4-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE"><span class="toc-number">3.4.</span> <span class="toc-text">3.3.4 为什么使用不可变数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-5-%E6%9C%89%E7%8A%B6%E6%80%81%E7%BB%84%E4%BB%B6%E5%92%8C%E6%97%A0%E7%8A%B6%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">3.5.</span> <span class="toc-text">3.3.5 有状态组件和无状态组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Stateful"><span class="toc-number">3.5.1.</span> <span class="toc-text">Stateful</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Stateless"><span class="toc-number">3.5.2.</span> <span class="toc-text">Stateless</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-6-%E6%89%A9%E5%B1%95%E8%B5%84%E6%96%99"><span class="toc-number">3.6.</span> <span class="toc-text">3.3.6 扩展资料</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">4.</span> <span class="toc-text">3.4 生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.</span> <span class="toc-text">3.4.1 三个阶段的生命周期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">4.1.1.</span> <span class="toc-text">三个阶段生命周期</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E5%88%9B%E5%BB%BA%E9%98%B6%E6%AE%B5"><span class="toc-number">4.2.</span> <span class="toc-text">3.4.2 创建阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E9%98%B6%E6%AE%B5constructor"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 创建阶段constructor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E9%98%B6%E6%AE%B5componentWillMount-16-3%E7%A7%BB%E9%99%A4"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 创建阶段componentWillMount(16.3移除)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E9%98%B6%E6%AE%B5render"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 创建阶段render</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E9%98%B6%E6%AE%B5componentDidMount"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 创建阶段componentDidMount</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5"><span class="toc-number">4.3.</span> <span class="toc-text">3.4.3 更新阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5componentWillReceiveProps-16-3%E7%A7%BB%E9%99%A4"><span class="toc-number">4.3.1.</span> <span class="toc-text">1.更新阶段componentWillReceiveProps(16.3移除)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5shouldComponentUpdate"><span class="toc-number">4.3.2.</span> <span class="toc-text">2.更新阶段shouldComponentUpdate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5componentDidUpdate"><span class="toc-number">4.3.3.</span> <span class="toc-text">3.更新阶段componentDidUpdate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-4-%E5%8D%B8%E8%BD%BD%E9%98%B6%E6%AE%B5-componentWillUnmount"><span class="toc-number">4.4.</span> <span class="toc-text">3.4.4 卸载阶段 componentWillUnmount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-5-%E5%9B%BE%E8%A7%A3%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">4.5.</span> <span class="toc-text">3.4.5 图解生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A7%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">4.5.1.</span> <span class="toc-text">旧的生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">4.5.2.</span> <span class="toc-text">新的生命周期</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-6-%E6%89%A9%E5%B1%95%E8%B5%84%E6%96%99"><span class="toc-number">4.6.</span> <span class="toc-text">3.4.6 扩展资料</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-React%E7%BB%84%E4%BB%B6%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">3.5 React组件设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-1-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">3.5.1 高阶组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E5%81%87%E5%A6%82%E5%A4%9A%E4%B8%AA%E7%BB%84%E4%BB%B6%E9%9C%80%E8%A6%81%E9%BC%A0%E6%A0%87%E6%BB%91%E5%85%A5%E6%97%B6%E7%BB%99%E4%B8%AA%E6%8F%90%E7%A4%BA%EF%BC%8C%E6%BB%91%E5%87%BA%E6%97%B6%E6%B8%85%E7%A9%BA%E6%8F%90%E7%A4%BA%EF%BC%8C%E9%82%A3%E4%B9%88%E5%8F%AF%E4%BB%A5%E6%8A%8A%E8%BF%99%E4%B8%AA%E5%85%AC%E5%85%B1%E6%8F%90%E7%A4%BA%E6%8A%BD%E7%A6%BB%E5%87%BA%E6%9D%A5%E5%A4%8D%E7%94%A8"><span class="toc-number">5.1.1.</span> <span class="toc-text">案例：假如多个组件需要鼠标滑入时给个提示，滑出时清空提示，那么可以把这个公共提示抽离出来复用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%89%B9%E6%80%A7"><span class="toc-number">5.1.2.</span> <span class="toc-text">高阶组件特性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-2-%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%AD%90%E7%BB%84%E4%BB%B6%EF%BC%88renderProps%EF%BC%89"><span class="toc-number">5.2.</span> <span class="toc-text">3.5.2 函数作为子组件（renderProps）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84"><span class="toc-number">5.2.1.</span> <span class="toc-text">结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%B9%E5%86%99%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="toc-number">5.2.2.</span> <span class="toc-text">改写上面的案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-3-%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%AD%90%E7%BB%84%E4%BB%B6%EF%BC%88Children%EF%BC%89"><span class="toc-number">5.3.</span> <span class="toc-text">3.5.3 函数作为子组件（Children）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-4-%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB"><span class="toc-number">5.4.</span> <span class="toc-text">3.5.4 扩展阅读</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/59814/" title="React状态管理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_7.jpg" onerror='this.onerror=null,this.src="/img/404.png"' alt="React状态管理"></a><div class="content"><a class="title" href="/59814/" title="React状态管理">React状态管理</a><time datetime="2022-02-08T06:21:43.000Z" title="发表于 2022-02-08 14:21:43">2022-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/59815/" title="React高级实战"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_6.jpg" onerror='this.onerror=null,this.src="/img/404.png"' alt="React高级实战"></a><div class="content"><a class="title" href="/59815/" title="React高级实战">React高级实战</a><time datetime="2022-02-08T06:21:43.000Z" title="发表于 2022-02-08 14:21:43">2022-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/11559/" title="React hooks"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_3.jpg" onerror='this.onerror=null,this.src="/img/404.png"' alt="React hooks"></a><div class="content"><a class="title" href="/11559/" title="React hooks">React hooks</a><time datetime="2022-02-08T06:21:43.000Z" title="发表于 2022-02-08 14:21:43">2022-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/59622/" title="React原理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_9.jpg" onerror='this.onerror=null,this.src="/img/404.png"' alt="React原理"></a><div class="content"><a class="title" href="/59622/" title="React原理">React原理</a><time datetime="2022-02-08T06:21:39.000Z" title="发表于 2022-02-08 14:21:39">2022-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/10279/" title="React生态"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_7.jpg" onerror='this.onerror=null,this.src="/img/404.png"' alt="React生态"></a><div class="content"><a class="title" href="/10279/" title="React生态">React生态</a><time datetime="2022-02-08T06:21:34.000Z" title="发表于 2022-02-08 14:21:34">2022-02-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By souldjl</div><div class="footer_custom_text">没有行动的梦想，都是妄想～</div><a href="/statement">免责申明</a></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource(){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css",document.getElementsByTagName("head")[0].appendChild(t)}function loadGitalk(){function t(){new Gitalk(Object.assign({clientID:"28388bc5382cb36e8b6a",clientSecret:"0976a3fb2d62d4e2b86385d26451a23ead66f6eb",repo:"souldjl.github.io",owner:"souldjl",admin:["souldjl"],id:"0e0c39162aadf0913be72320ad3acd70",updateCountCallback:commentCount},null)).render("gitalk-container")}"function"==typeof Gitalk?t():(addGitalkSource(),getScript("https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js").then(t))}function commentCount(t){let e=document.querySelector("#post-meta .gitalk-comment-count");e&&(e.innerHTML=t)}function loadOtherComment(){loadGitalk()}loadGitalk()</script></div><script src="https://cdn.bootcdn.net/ajax/libs/Swiper/7.4.1/swiper-bundle.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",function(){if(window.removeEventListener("scroll",window.tocScrollFn),window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")}),document.addEventListener("pjax:complete",function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script");var o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>